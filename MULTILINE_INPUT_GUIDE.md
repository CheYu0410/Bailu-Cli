# 多行輸入使用指南

## ⚠️ 重要說明

**Node.js Terminal 限制：** 在標準的 terminal/PowerShell 環境中，**無法檢測 Shift+Enter**。這是 Node.js `readline` 模組的技術限制，不是 bug。

## ✅ 正確用法：行尾續行符 `\`

### 基本用法

```bash
你: 請幫我實現一個函數：\
... - 參數1: 用戶名稱
... - 參數2: 郵箱地址
... - 返回：驗證結果
...                    ← 輸入空行（直接按 Enter）

[AI 開始處理多行輸入...]
```

### 步驟說明

1. **開始多行輸入**
   - 在第一行的 **行尾** 輸入 `\`
   - 按 `Enter`
   - 提示符變為 `...`

2. **繼續輸入**
   - 如果該行 **行尾有 `\`**，按 Enter 後會繼續下一行
   - 如果該行 **行尾沒有 `\`**，按 Enter 後會立即提交

3. **提交規則**
   - **有 `\`** = 繼續輸入
   - **無 `\`** = 結束並提交

## 📝 實際例子

### 例子 1：創建函數

```bash
你: 創建一個 TypeScript 函數：\
... \
... function validateEmail(email: string): boolean {\
...   // 驗證郵箱格式\
... }
                       ← 最後一行沒有 \，立即提交
```

### 例子 2：代碼審查

```bash
你: 請審查這段代碼：\
... \
... const users = data.map(u => ({\
...   id: u.id,\
...   name: u.name\
... }))
                       ← 最後一行沒有 \，立即提交
```

### 例子 3：長問題

```bash
你: 我有一個問題：\
... 1. 如何優化這個查詢？\
... 2. 有沒有更好的索引方案？\
... 3. 需要考慮哪些性能因素？
                       ← 最後一行沒有 \，立即提交
```

### 例子 4：Shell 標準用法

```bash
你: 請修改以下配置：\
... server_name example.com;\
... listen 80;\
... root /var/www/html
                       ← 完成，提交
```

## ❌ 為什麼 Shift+Enter 不工作？

### 技術原因

Node.js 的 `readline` 模組在處理鍵盤輸入時：

1. **無法可靠檢測修飾鍵**（Shift、Ctrl、Alt）在 Windows PowerShell 中
2. **Enter 鍵** 會立即觸發 `line` 事件，無法延遲判斷
3. **Raw mode** 雖然可以檢測某些按鍵，但會破壞 terminal 的正常行為（歷史記錄、自動補全等）

### 其他 CLI 工具的做法

- **Aider**: 使用 `\` 續行符
- **Python REPL**: 自動檢測未閉合的括號/引號
- **Bash/Zsh**: 使用 `\` 續行符
- **Git commit message**: 使用文本編輯器

## 🎯 最佳實踐

### 短輸入（< 1 行）
```bash
你: 修改 README
```

### 中等輸入（2-3 行）
```bash
你: 創建一個函數：\
... - 接收數組
... - 返回排序結果
...
```

### 長輸入（> 3 行）
建議使用 `/add` 添加文件到上下文，然後引用：

```bash
你: /add docs/requirements.md
你: 根據 requirements.md 實現功能
```

## 💡 提示

1. **Ctrl+C** 可以取消當前的多行輸入
2. **空行** 是提交的信號，不會被包含在最終內容中
3. 行尾的 `\` 會被自動移除
4. 可以在任何時候開始多行輸入

## 🚀 未來可能的改進

如果需要更好的多行編輸體驗，可以考慮：

1. **外部編輯器支持** - `/edit` 命令打開編輯器
2. **粘貼模式** - 自動檢測大段文本粘貼
3. **文件輸入** - `/input file.txt` 從文件讀取

但目前的 `\` 續行符已經是標準且可靠的方案。
