# V0.2.6 - 用戶體驗優化

## 更新日期
2026-01-05

## 概述
本次更新專注於提升 Bailu CLI 的用戶體驗，包含發言者標示、視覺區塊和程式碼語法高亮等功能。

## 主要改進

### 1. 發言者標示優化
- **用戶提示符**: 從 `你:` 改為 `You:`，使用粗體青色 (`chalk.bold.cyan`)
- **AI 提示符**: 從 `Bailu:` 改為粗體綠色 (`chalk.bold.green`)
- **多行輸入**: 續行提示符改為 `  ... `，增加縮排提升可讀性

### 2. 視覺分隔線
- 每輪對話之間自動添加分隔線（60 個字符寬度）
- AI 回覆開始前顯示分隔線，提升視覺層次
- 統一使用 `chalk.gray("─".repeat(60))` 格式

### 3. 程式碼語法高亮

#### 新增套件
```bash
npm install cli-highlight
```

#### 新增模組
- **檔案**: `src/utils/code-highlighter.ts`
- **功能**:
  - `highlightCode()`: 高亮單個程式碼區塊
  - `processResponseWithHighlight()`: 處理 Markdown 程式碼區塊
  - `hasCodeBlocks()`: 檢測是否包含程式碼

#### 支援的程式語言
- JavaScript / TypeScript
- Python
- HTML / CSS
- JSON
- 以及 cli-highlight 支援的其他語言

#### 顏色主題
- 關鍵字: 青色 (cyan)
- 字串: 綠色 (green)
- 數字: 黃色 (yellow)
- 註解: 灰色 (gray)
- 函數: 藍色 (blue)
- 類別: 洋紅色 (magenta)

### 4. 檔案修改清單

#### 新增檔案
- `src/utils/code-highlighter.ts` - 程式碼高亮工具模組

#### 修改檔案
- `src/agent/chat.ts`
  - 用戶提示符改為 `chalk.bold.cyan("\nYou: ")`
  - 多行續行提示符改為 `chalk.gray("  ... ")`
  - 每輪對話結束後添加分隔線

- `src/agent/orchestrator.ts`
  - 導入 `processResponseWithHighlight` 工具
  - AI 回覆開始前添加分隔線
  - AI 名稱改為 `chalk.bold.green("Bailu: ")`

## 使用範例

### 對話格式
```
────────────────────────────────────────────────────────────
You: 創建一個 Hello World 函數

────────────────────────────────────────────────────────────
Bailu: 我來為您創建一個 Hello World 函數：

[javascript]
function helloWorld() {
  console.log('Hello, World!');
}

helloWorld();

函數已創建完成，程式碼已套用語法高亮。

[SUCCESS] 工具執行成功
────────────────────────────────────────────────────────────
```

### 多行輸入
```
You: 第一行\
  ... 第二行\
  ... 第三行
```

## 技術細節

### 相容性
- 向後相容，不影響現有功能
- 語法高亮失敗時自動降級為原始程式碼
- 適用於所有支援 ANSI 顏色的終端機

### 效能
- 程式碼高亮僅在檢測到 Markdown 程式碼區塊時執行
- 使用正則表達式進行高效匹配
- 不影響非程式碼內容的輸出速度

### 設計原則
- **專業風格**: 移除所有 Emoji，保持專業開發工具的定位
- **清晰層次**: 使用顏色和粗體區分不同元素
- **一致性**: 統一的視覺語言和間距規則

## 未來計劃

### 可選功能
- [ ] 支援自訂顏色主題
- [ ] 可配置的分隔線樣式
- [ ] 更多語法高亮選項
- [ ] 差異對比高亮（diff highlighting）

### 增強功能
- [ ] 支援行號顯示
- [ ] 程式碼區塊摺疊
- [ ] 互動式程式碼預覽

## 升級說明

本次更新自動安裝新依賴，無需額外配置。升級步驟：

```bash
# 拉取最新代碼
git pull

# 安裝依賴
npm install

# 編譯
npm run build

# 測試
npm start
```

## 回饋

如有任何問題或建議，歡迎提交 Issue 或 Pull Request。

---

**版本**: v0.2.6  
**作者**: Bailu AI Team  
**日期**: 2026-01-05
